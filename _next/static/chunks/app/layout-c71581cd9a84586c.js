(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{347:()=>{},1868:(e,t,r)=>{"use strict";r.d(t,{A:()=>i,AuthProvider:()=>d});var s=r(5155),o=r(2115),l=r(2099),a=r(9323);let n=(0,o.createContext)({user:null,profile:null,loading:!0,signOut:async()=>{},refreshProfile:async()=>{},resetProfile:async()=>{}}),i=()=>{let e=(0,o.useContext)(n);if(!e)throw Error("useAuth must be used within an AuthProvider");return e},d=e=>{let{children:t}=e,[r,i]=(0,o.useState)(null),[d,c]=(0,o.useState)(null),[u,h]=(0,o.useState)(!0),m=async e=>{var t,r;let s=(null==(t=e.user_metadata)?void 0:t.full_name)||(null==(r=e.user_metadata)?void 0:r.name)||void 0;return await a.E.ensureProfile(e.id,e.email,s)};(0,o.useEffect)(()=>{(async()=>{let{data:{session:e}}=await l.N.auth.getSession();if((null==e?void 0:e.user)&&e.user.email){let t={id:e.user.id,email:e.user.email,user_metadata:e.user.user_metadata};i(t),c(await m(t))}h(!1)})();let{data:{subscription:e}}=l.N.auth.onAuthStateChange(async(e,t)=>{if((null==t?void 0:t.user)&&t.user.email){let e={id:t.user.id,email:t.user.email,user_metadata:t.user.user_metadata};i(e),c(await m(e))}else i(null),c(null);h(!1)});return()=>e.unsubscribe()},[]);let g=async()=>{r&&c(await a.E.getProfile(r.id))},p=async()=>{r&&c(await a.E.resetProfile(r.id))},f=async()=>{await l.N.auth.signOut(),i(null),c(null)};return(0,s.jsx)(n.Provider,{value:{user:r,profile:d,loading:u,signOut:f,refreshProfile:g,resetProfile:p},children:t})}},2099:(e,t,r)=>{"use strict";r.d(t,{N:()=>a});var s=r(5647);let o="https://gbljleyzspkuflqwsalf.supabase.co",l="sb_publishable_OLCFA9uKB3KcBWsuIZc9_g_KIbzMAsU";if(!o||!l)throw Error("Missing Supabase environment variables");let a=(0,s.UU)(o,l,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}})},2236:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,8346,23)),Promise.resolve().then(r.t.bind(r,347,23)),Promise.resolve().then(r.bind(r,1868)),Promise.resolve().then(r.bind(r,9056)),Promise.resolve().then(r.bind(r,7280))},7280:(e,t,r)=>{"use strict";r.d(t,{D:()=>a,ThemeProvider:()=>n});var s=r(5155),o=r(2115);let l=(0,o.createContext)({theme:"light",toggleTheme:()=>{},setTheme:()=>{}}),a=()=>(0,o.useContext)(l),n=e=>{let{children:t}=e,[r,a]=(0,o.useState)("light"),[n,i]=(0,o.useState)(!1),d=e=>{console.log("Applying theme:",e);let t=document.documentElement,r=document.body;t.classList.remove("dark"),r.classList.remove("dark"),t.removeAttribute("data-theme"),r.removeAttribute("data-theme"),t.style.removeProperty("color-scheme"),"dark"===e?(t.classList.add("dark"),r.classList.add("dark"),t.setAttribute("data-theme","dark"),r.setAttribute("data-theme","dark"),t.style.colorScheme="dark",console.log("Applied dark theme - classes added")):(t.classList.remove("dark"),r.classList.remove("dark"),t.setAttribute("data-theme","light"),r.setAttribute("data-theme","light"),t.style.colorScheme="light",console.log("Applied light theme - dark classes removed")),localStorage.setItem("theme",e),console.log("Saved theme to localStorage:",e),window.dispatchEvent(new CustomEvent("themeChange",{detail:{theme:e}})),setTimeout(()=>{console.log("Final state - HTML classes:",t.classList.toString()),console.log("Final state - Body classes:",r.classList.toString()),console.log("Final state - Data theme:",t.getAttribute("data-theme"))},100)};return((0,o.useEffect)(()=>{i(!0);{let e=localStorage.getItem("theme"),t="light";if(e&&("light"===e||"dark"===e))console.log("Loading saved theme:",e),t=e;else{let e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";console.log("Using system theme:",e),t=e}a(t),d(t)}},[]),(0,o.useEffect)(()=>{n&&d(r)},[r,n]),n)?(console.log("ThemeProvider rendering with theme:",r),(0,s.jsx)(l.Provider,{value:{theme:r,toggleTheme:()=>{console.log("Toggle theme called, current theme:",r),a(e=>{let t="light"===e?"dark":"light";return console.log("Setting theme to:",t),t})},setTheme:e=>{console.log("Setting theme directly to:",e),a(e)}},children:t})):(console.log("ThemeProvider not mounted yet, hiding children"),(0,s.jsx)("div",{style:{visibility:"hidden"},children:t}))}},8346:e=>{e.exports={style:{fontFamily:"'Inter', 'Inter Fallback'",fontStyle:"normal"},className:"__className_e8ce0c"}},9056:(e,t,r)=>{"use strict";r.d(t,{ThemeDebug:()=>a});var s=r(5155),o=r(7280),l=r(2115);let a=()=>{let{theme:e,toggleTheme:t,setTheme:r}=(0,o.D)(),[a,n]=(0,l.useState)(""),[i,d]=(0,l.useState)(""),[c,u]=(0,l.useState)(""),[h,m]=(0,l.useState)(""),g=()=>{{let e=document.documentElement,t=document.body;n(e.classList.toString()),d(t.classList.toString()),u(e.getAttribute("data-theme")||"none"),m(e.style.colorScheme||"none"),console.log("Debug info updated:",{htmlClasses:e.classList.toString(),bodyClasses:t.classList.toString(),dataTheme:e.getAttribute("data-theme"),colorScheme:e.style.colorScheme})}};return(0,l.useEffect)(()=>{g()},[e]),(0,l.useEffect)(()=>{{let e=()=>{setTimeout(g,50)};return window.addEventListener("themeChange",e),()=>window.removeEventListener("themeChange",e)}},[]),(0,s.jsxs)("div",{className:"theme-debug",children:[(0,s.jsx)("div",{style:{fontWeight:"bold",marginBottom:"8px"},children:"Theme Debug"}),(0,s.jsxs)("div",{children:["Current Theme: ",(0,s.jsx)("strong",{children:e})]}),(0,s.jsxs)("div",{children:["HTML Classes: ",a||"none"]}),(0,s.jsxs)("div",{children:["Body Classes: ",i||"none"]}),(0,s.jsxs)("div",{children:["Data Theme: ",c]}),(0,s.jsxs)("div",{children:["Color Scheme: ",h]}),(0,s.jsxs)("div",{children:["Background: ",(0,s.jsx)("span",{style:{backgroundColor:"var(--background)",padding:"2px 4px",borderRadius:"2px"},children:"Sample"})]}),(0,s.jsxs)("div",{children:["Foreground: ",(0,s.jsx)("span",{style:{color:"var(--foreground)"},children:"Sample Text"})]}),(0,s.jsxs)("div",{style:{marginTop:"8px",display:"flex",flexDirection:"column",gap:"4px"},children:[(0,s.jsx)("button",{onClick:()=>{console.log("Manual toggle clicked"),t(),setTimeout(g,100)},style:{padding:"4px 8px",backgroundColor:"var(--primary)",color:"var(--primary-foreground)",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"10px"},children:"Toggle Theme"}),(0,s.jsx)("button",{onClick:()=>{console.log("Force light theme clicked"),r("light"),setTimeout(g,100)},style:{padding:"4px 8px",backgroundColor:"#fbbf24",color:"#000",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"10px"},children:"Force Light"}),(0,s.jsx)("button",{onClick:()=>{console.log("Force dark theme clicked"),r("dark"),setTimeout(g,100)},style:{padding:"4px 8px",backgroundColor:"#374151",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"10px"},children:"Force Dark"}),(0,s.jsx)("button",{onClick:()=>{console.log("Force refresh clicked");let t=document.documentElement,r=document.body;t.classList.remove("dark"),r.classList.remove("dark"),t.removeAttribute("data-theme"),r.removeAttribute("data-theme"),t.style.removeProperty("color-scheme"),"dark"===e?(t.classList.add("dark"),r.classList.add("dark"),t.setAttribute("data-theme","dark"),r.setAttribute("data-theme","dark"),t.style.colorScheme="dark"):(t.setAttribute("data-theme","light"),r.setAttribute("data-theme","light"),t.style.colorScheme="light"),setTimeout(g,100)},style:{padding:"4px 8px",backgroundColor:"#ef4444",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"10px"},children:"Force Refresh"}),(0,s.jsx)("button",{onClick:()=>{console.log("Manual refresh clicked"),g()},style:{padding:"4px 8px",backgroundColor:"#10b981",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"10px"},children:"Manual Refresh"})]})]})}},9323:(e,t,r)=>{"use strict";r.d(t,{E:()=>o});var s=r(2099);let o={async getProfile(e){try{let{data:t,error:r}=await s.N.from("profiles").select("*").eq("id",e).single();if(r){if("PGRST116"===r.code)return null;throw r}return t}catch(e){return console.error("Error fetching profile:",e),null}},async createProfile(e){try{let{data:t,error:r}=await s.N.from("profiles").insert(e).select().single();if(r)throw r;return t}catch(e){return console.error("Error creating profile:",e),null}},async updateProfile(e,t){try{let{data:r,error:o}=await s.N.from("profiles").update(t).eq("id",e).select().single();if(o)throw o;return r}catch(e){return console.error("Error updating profile:",e),null}},async upsertProfile(e){try{let{data:t,error:r}=await s.N.from("profiles").upsert(e).select().single();if(r)throw r;return t}catch(e){return console.error("Error upserting profile:",e),null}},async ensureProfile(e,t,r){let s=await this.getProfile(e);return s||(s=await this.createProfile({id:e,email:t,full_name:r||null,job_type:null,swedish_level:null})),s},async signOut(){console.log("Sign out requested")},async getUserProgress(e){try{let{data:t,error:r}=await s.N.from("user_progress").select("*").eq("user_id",e);if(r)throw r;return t||[]}catch(e){return console.error("Error fetching user progress:",e),[]}},async saveLessonProgress(e){try{let{data:t,error:r}=await s.N.from("user_progress").upsert({user_id:e.user_id,lesson_id:e.lesson_id,completed:e.completed||!1,score:e.score||0,completed_at:e.completed?new Date().toISOString():null}).select().single();if(r)throw r;return t}catch(e){return console.error("Error saving lesson progress:",e),null}},async getAuthToken(){try{let{data:{session:e}}=await s.N.auth.getSession();return(null==e?void 0:e.access_token)||null}catch(e){return console.error("Error getting auth token:",e),null}},async resetProfile(e){try{let{data:t,error:r}=await s.N.from("profiles").update({job_type:null,swedish_level:null}).eq("id",e).select().single();if(r)throw r;return t}catch(e){return console.error("Error resetting profile:",e),null}}}}},e=>{e.O(0,[838,647,441,964,358],()=>e(e.s=2236)),_N_E=e.O()}]);