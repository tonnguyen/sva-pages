(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{347:()=>{},1868:(e,t,r)=>{"use strict";r.d(t,{A:()=>i,AuthProvider:()=>d});var o=r(5155),s=r(2115),l=r(2099),a=r(9323);let n=(0,s.createContext)({user:null,profile:null,loading:!0,signOut:async()=>{},refreshProfile:async()=>{},resetProfile:async()=>{}}),i=()=>{let e=(0,s.useContext)(n);if(!e)throw Error("useAuth must be used within an AuthProvider");return e},d=e=>{let{children:t}=e,[r,i]=(0,s.useState)(null),[d,c]=(0,s.useState)(null),[u,m]=(0,s.useState)(!0),p=async e=>{var t,r;let o=(null==(t=e.user_metadata)?void 0:t.full_name)||(null==(r=e.user_metadata)?void 0:r.name)||void 0;return await a.E.ensureProfile(e.id,e.email,o)};(0,s.useEffect)(()=>{(async()=>{let{data:{session:e}}=await l.N.auth.getSession();if((null==e?void 0:e.user)&&e.user.email){let t={id:e.user.id,email:e.user.email,user_metadata:e.user.user_metadata};i(t),c(await p(t))}m(!1)})();let{data:{subscription:e}}=l.N.auth.onAuthStateChange(async(e,t)=>{if((null==t?void 0:t.user)&&t.user.email){let e={id:t.user.id,email:t.user.email,user_metadata:t.user.user_metadata};i(e),c(await p(e))}else i(null),c(null);m(!1)});return()=>e.unsubscribe()},[]);let f=async()=>{r&&c(await a.E.getProfile(r.id))},g=async()=>{r&&c(await a.E.resetProfile(r.id))},y=async()=>{await l.N.auth.signOut(),i(null),c(null)};return(0,o.jsx)(n.Provider,{value:{user:r,profile:d,loading:u,signOut:y,refreshProfile:f,resetProfile:g},children:t})}},2099:(e,t,r)=>{"use strict";r.d(t,{N:()=>a});var o=r(5647);let s="https://gbljleyzspkuflqwsalf.supabase.co",l="sb_publishable_OLCFA9uKB3KcBWsuIZc9_g_KIbzMAsU";if(!s||!l)throw Error("Missing Supabase environment variables");let a=(0,o.UU)(s,l,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}})},2236:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,8346,23)),Promise.resolve().then(r.t.bind(r,347,23)),Promise.resolve().then(r.bind(r,1868)),Promise.resolve().then(r.bind(r,9056)),Promise.resolve().then(r.bind(r,7280))},7280:(e,t,r)=>{"use strict";r.d(t,{D:()=>a,ThemeProvider:()=>n});var o=r(5155),s=r(2115);let l=(0,s.createContext)({theme:"light",toggleTheme:()=>{},setTheme:()=>{}}),a=()=>(0,s.useContext)(l),n=e=>{let{children:t}=e,[r,a]=(0,s.useState)("light"),[n,i]=(0,s.useState)(!1),d=e=>{document.querySelectorAll('[class*="bg-"], [class*="text-"], [class*="border-"]').forEach(t=>{let r=t.className.split(" ").map(t=>{if("light"===e){if(t.includes("bg-slate-9")||t.includes("bg-gray-9")||t.includes("bg-slate-8")||t.includes("bg-gray-8")||t.includes("bg-slate-7")||t.includes("bg-gray-7"))return t.replace(/bg-slate-[89]/,"bg-white").replace(/bg-gray-[89]/,"bg-white");if(t.includes("text-white")||t.includes("text-slate-100")||t.includes("text-gray-100"))return t.replace(/text-white|text-slate-100|text-gray-100/,"text-gray-900");if(t.includes("border-slate-7")||t.includes("border-gray-7"))return t.replace(/border-slate-7|border-gray-7/,"border-gray-200")}else{if(t.includes("bg-white")||t.includes("bg-slate-50")||t.includes("bg-gray-50"))return t.replace(/bg-white|bg-slate-50|bg-gray-50/,"bg-slate-900");if(t.includes("text-gray-9")||t.includes("text-slate-9"))return t.replace(/text-gray-9|text-slate-9/,"text-white");if(t.includes("border-gray-2")||t.includes("border-slate-2"))return t.replace(/border-gray-2|border-slate-2/,"border-slate-700")}return t});t.className=r.join(" ")})},c=e=>{console.log("Applying theme:",e);let t=document.documentElement,r=document.body;t.classList.remove("dark"),r.classList.remove("dark"),t.removeAttribute("data-theme"),r.removeAttribute("data-theme"),t.style.removeProperty("color-scheme"),"dark"===e?(t.classList.add("dark"),r.classList.add("dark"),t.setAttribute("data-theme","dark"),r.setAttribute("data-theme","dark"),t.style.colorScheme="dark",console.log("Applied dark theme - classes added")):(t.classList.remove("dark"),r.classList.remove("dark"),t.setAttribute("data-theme","light"),r.setAttribute("data-theme","light"),t.style.colorScheme="light",console.log("Applied light theme - dark classes removed")),"light"===e?(t.style.setProperty("--background","#ffffff","important"),t.style.setProperty("--foreground","#171717","important"),t.style.setProperty("--card","#ffffff","important"),t.style.setProperty("--card-foreground","#171717","important"),t.style.setProperty("--popover","#ffffff","important"),t.style.setProperty("--popover-foreground","#171717","important"),t.style.setProperty("--primary","#2563eb","important"),t.style.setProperty("--primary-foreground","#ffffff","important"),t.style.setProperty("--secondary","#f1f5f9","important"),t.style.setProperty("--secondary-foreground","#0f172a","important"),t.style.setProperty("--muted","#f1f5f9","important"),t.style.setProperty("--muted-foreground","#64748b","important"),t.style.setProperty("--accent","#f1f5f9","important"),t.style.setProperty("--accent-foreground","#0f172a","important"),t.style.setProperty("--destructive","#ef4444","important"),t.style.setProperty("--destructive-foreground","#ffffff","important"),t.style.setProperty("--border","#e2e8f0","important"),t.style.setProperty("--input","#e2e8f0","important"),t.style.setProperty("--ring","#2563eb","important"),r.style.setProperty("background","#ffffff","important"),r.style.setProperty("color","#171717","important"),setTimeout(()=>d("light"),50)):(t.style.setProperty("--background","#0f172a","important"),t.style.setProperty("--foreground","#f8fafc","important"),t.style.setProperty("--card","#1e293b","important"),t.style.setProperty("--card-foreground","#f8fafc","important"),t.style.setProperty("--popover","#1e293b","important"),t.style.setProperty("--popover-foreground","#f8fafc","important"),t.style.setProperty("--primary","#3b82f6","important"),t.style.setProperty("--primary-foreground","#ffffff","important"),t.style.setProperty("--secondary","#334155","important"),t.style.setProperty("--secondary-foreground","#f1f5f9","important"),t.style.setProperty("--muted","#334155","important"),t.style.setProperty("--muted-foreground","#94a3b8","important"),t.style.setProperty("--accent","#334155","important"),t.style.setProperty("--accent-foreground","#f1f5f9","important"),t.style.setProperty("--destructive","#ef4444","important"),t.style.setProperty("--destructive-foreground","#ffffff","important"),t.style.setProperty("--border","#475569","important"),t.style.setProperty("--input","#475569","important"),t.style.setProperty("--ring","#3b82f6","important"),r.style.setProperty("background","#0f172a","important"),r.style.setProperty("color","#f8fafc","important"),setTimeout(()=>d("dark"),50)),localStorage.setItem("theme",e),console.log("Saved theme to localStorage:",e),window.dispatchEvent(new CustomEvent("themeChange",{detail:{theme:e}})),setTimeout(()=>{console.log("Final state - HTML classes:",t.classList.toString()),console.log("Final state - Body classes:",r.classList.toString()),console.log("Final state - Data theme:",t.getAttribute("data-theme")),console.log("Final state - Background color:",getComputedStyle(r).backgroundColor),console.log("Final state - Text color:",getComputedStyle(r).color)},100)};return((0,s.useEffect)(()=>{i(!0);{let e=localStorage.getItem("theme"),t="light";if(e&&("light"===e||"dark"===e))console.log("Loading saved theme:",e),t=e;else{let e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";console.log("Using system theme:",e),t=e}a(t),c(t)}},[]),(0,s.useEffect)(()=>{n&&c(r)},[r,n]),n)?(console.log("ThemeProvider rendering with theme:",r),(0,o.jsx)(l.Provider,{value:{theme:r,toggleTheme:()=>{console.log("Toggle theme called, current theme:",r),a(e=>{let t="light"===e?"dark":"light";return console.log("Setting theme to:",t),t})},setTheme:e=>{console.log("Setting theme directly to:",e),a(e)}},children:t})):(console.log("ThemeProvider not mounted yet, hiding children"),(0,o.jsx)("div",{style:{visibility:"hidden"},children:t}))}},8346:e=>{e.exports={style:{fontFamily:"'Inter', 'Inter Fallback'",fontStyle:"normal"},className:"__className_e8a10c"}},9056:(e,t,r)=>{"use strict";r.d(t,{ThemeDebug:()=>a});var o=r(5155),s=r(7280),l=r(2115);let a=()=>{let{theme:e,toggleTheme:t,setTheme:r}=(0,s.D)(),[a,n]=(0,l.useState)(""),[i,d]=(0,l.useState)(""),[c,u]=(0,l.useState)(""),[m,p]=(0,l.useState)(""),f=()=>{{let e=document.documentElement,t=document.body;n(e.classList.toString()),d(t.classList.toString()),u(e.getAttribute("data-theme")||"none"),p(e.style.colorScheme||"none"),console.log("Debug info updated:",{htmlClasses:e.classList.toString(),bodyClasses:t.classList.toString(),dataTheme:e.getAttribute("data-theme"),colorScheme:e.style.colorScheme})}};return(0,l.useEffect)(()=>{f()},[e]),(0,l.useEffect)(()=>{{let e=()=>{setTimeout(f,50)};return window.addEventListener("themeChange",e),()=>window.removeEventListener("themeChange",e)}},[]),(0,o.jsxs)("div",{className:"theme-debug",children:[(0,o.jsx)("div",{style:{fontWeight:"bold",marginBottom:"8px"},children:"Theme Debug"}),(0,o.jsxs)("div",{children:["Current Theme: ",(0,o.jsx)("strong",{children:e})]}),(0,o.jsxs)("div",{children:["HTML Classes: ",a||"none"]}),(0,o.jsxs)("div",{children:["Body Classes: ",i||"none"]}),(0,o.jsxs)("div",{children:["Data Theme: ",c]}),(0,o.jsxs)("div",{children:["Color Scheme: ",m]}),(0,o.jsxs)("div",{children:["Background: ",(0,o.jsx)("span",{style:{backgroundColor:"var(--background)",padding:"2px 4px",borderRadius:"2px"},children:"Sample"})]}),(0,o.jsxs)("div",{children:["Foreground: ",(0,o.jsx)("span",{style:{color:"var(--foreground)"},children:"Sample Text"})]}),(0,o.jsxs)("div",{style:{marginTop:"8px",display:"flex",flexDirection:"column",gap:"4px"},children:[(0,o.jsx)("button",{onClick:()=>{console.log("Manual toggle clicked"),t(),setTimeout(f,100)},style:{padding:"4px 8px",backgroundColor:"var(--primary)",color:"var(--primary-foreground)",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"10px"},children:"Toggle Theme"}),(0,o.jsx)("button",{onClick:()=>{console.log("Force light theme clicked"),r("light"),setTimeout(f,100)},style:{padding:"4px 8px",backgroundColor:"#fbbf24",color:"#000",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"10px"},children:"Force Light"}),(0,o.jsx)("button",{onClick:()=>{console.log("Force dark theme clicked"),r("dark"),setTimeout(f,100)},style:{padding:"4px 8px",backgroundColor:"#374151",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"10px"},children:"Force Dark"}),(0,o.jsx)("button",{onClick:()=>{console.log("Force refresh clicked");let t=document.documentElement,r=document.body;t.classList.remove("dark"),r.classList.remove("dark"),t.removeAttribute("data-theme"),r.removeAttribute("data-theme"),t.style.removeProperty("color-scheme"),"dark"===e?(t.classList.add("dark"),r.classList.add("dark"),t.setAttribute("data-theme","dark"),r.setAttribute("data-theme","dark"),t.style.colorScheme="dark"):(t.setAttribute("data-theme","light"),r.setAttribute("data-theme","light"),t.style.colorScheme="light"),setTimeout(f,100)},style:{padding:"4px 8px",backgroundColor:"#ef4444",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"10px"},children:"Force Refresh"}),(0,o.jsx)("button",{onClick:()=>{console.log("Manual refresh clicked"),f()},style:{padding:"4px 8px",backgroundColor:"#10b981",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"10px"},children:"Manual Refresh"})]})]})}},9323:(e,t,r)=>{"use strict";r.d(t,{E:()=>s});var o=r(2099);let s={async getProfile(e){try{let{data:t,error:r}=await o.N.from("profiles").select("*").eq("id",e).single();if(r){if("PGRST116"===r.code)return null;throw r}return t}catch(e){return console.error("Error fetching profile:",e),null}},async createProfile(e){try{let{data:t,error:r}=await o.N.from("profiles").insert(e).select().single();if(r)throw r;return t}catch(e){return console.error("Error creating profile:",e),null}},async updateProfile(e,t){try{let{data:r,error:s}=await o.N.from("profiles").update(t).eq("id",e).select().single();if(s)throw s;return r}catch(e){return console.error("Error updating profile:",e),null}},async upsertProfile(e){try{let{data:t,error:r}=await o.N.from("profiles").upsert(e).select().single();if(r)throw r;return t}catch(e){return console.error("Error upserting profile:",e),null}},async ensureProfile(e,t,r){let o=await this.getProfile(e);return o||(o=await this.createProfile({id:e,email:t,full_name:r||null,job_type:null,swedish_level:null})),o},async signOut(){console.log("Sign out requested")},async getUserProgress(e){try{let{data:t,error:r}=await o.N.from("user_progress").select("*").eq("user_id",e);if(r)throw r;return t||[]}catch(e){return console.error("Error fetching user progress:",e),[]}},async saveLessonProgress(e){try{let{data:t,error:r}=await o.N.from("user_progress").upsert({user_id:e.user_id,lesson_id:e.lesson_id,completed:e.completed||!1,score:e.score||0,completed_at:e.completed?new Date().toISOString():null}).select().single();if(r)throw r;return t}catch(e){return console.error("Error saving lesson progress:",e),null}},async getAuthToken(){try{let{data:{session:e}}=await o.N.auth.getSession();return(null==e?void 0:e.access_token)||null}catch(e){return console.error("Error getting auth token:",e),null}},async resetProfile(e){try{let{data:t,error:r}=await o.N.from("profiles").update({job_type:null,swedish_level:null}).eq("id",e).select().single();if(r)throw r;return t}catch(e){return console.error("Error resetting profile:",e),null}}}}},e=>{e.O(0,[838,647,441,964,358],()=>e(e.s=2236)),_N_E=e.O()}]);