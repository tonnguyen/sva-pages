"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[787],{381:(e,t,r)=>{r.d(t,{A:()=>a});let a=(0,r(9946).A)("settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},1868:(e,t,r)=>{r.d(t,{A:()=>i,AuthProvider:()=>d});var a=r(5155),s=r(2115),o=r(2099),l=r(9323);let n=(0,s.createContext)({user:null,profile:null,loading:!0,signOut:async()=>{},refreshProfile:async()=>{},resetProfile:async()=>{}}),i=()=>{let e=(0,s.useContext)(n);if(!e)throw Error("useAuth must be used within an AuthProvider");return e},d=e=>{let{children:t}=e,[r,i]=(0,s.useState)(null),[d,c]=(0,s.useState)(null),[u,g]=(0,s.useState)(!0),m=async e=>{var t,r;let a=(null==(t=e.user_metadata)?void 0:t.full_name)||(null==(r=e.user_metadata)?void 0:r.name)||void 0;return await l.E.ensureProfile(e.id,e.email,a)};(0,s.useEffect)(()=>{(async()=>{let{data:{session:e}}=await o.N.auth.getSession();if((null==e?void 0:e.user)&&e.user.email){let t={id:e.user.id,email:e.user.email,user_metadata:e.user.user_metadata};i(t),c(await m(t))}g(!1)})();let{data:{subscription:e}}=o.N.auth.onAuthStateChange(async(e,t)=>{if((null==t?void 0:t.user)&&t.user.email){let e={id:t.user.id,email:t.user.email,user_metadata:t.user.user_metadata};i(e),c(await m(e))}else i(null),c(null);g(!1)});return()=>e.unsubscribe()},[]);let y=async()=>{r&&c(await l.E.getProfile(r.id))},f=async()=>{r&&c(await l.E.resetProfile(r.id))},p=async()=>{await o.N.auth.signOut(),i(null),c(null)};return(0,a.jsx)(n.Provider,{value:{user:r,profile:d,loading:u,signOut:p,refreshProfile:y,resetProfile:f},children:t})}},1935:(e,t,r)=>{r.d(t,{H:()=>y});var a=r(5155),s=r(2115),o=r(5695),l=r(1868),n=r(7280),i=r(9946);let d=(0,i.A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),c=(0,i.A)("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),u=(0,i.A)("moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);var g=r(381);let m=(0,i.A)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),y=e=>{var t;let{user:r,profile:i}=e,[y,f]=(0,s.useState)(!1),p=(0,s.useRef)(null),{signOut:h,resetProfile:b}=(0,l.A)(),{theme:v,toggleTheme:x}=(0,n.D)(),k=(0,o.useRouter)();(0,s.useEffect)(()=>{let e=e=>{p.current&&!p.current.contains(e.target)&&f(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let w=async()=>{try{await h(),window.location.href="/"}catch(e){console.error("Error signing out:",e),k.push("/")}},P=async()=>{try{await b(),k.push("/onboarding")}catch(e){console.error("Error restarting onboarding:",e),k.push("/onboarding")}},_=()=>{var e,t;return(null==(e=r.user_metadata)?void 0:e.avatar_url)?r.user_metadata.avatar_url:(null==i?void 0:i.full_name)?i.full_name.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):(null==(t=r.email)?void 0:t.charAt(0).toUpperCase())||"U"},N=!!(null==(t=r.user_metadata)?void 0:t.avatar_url);return(0,a.jsxs)("div",{className:"relative",ref:p,children:[(0,a.jsx)("div",{className:"absolute top-0 right-0 w-4 h-4 bg-red-500 rounded-full text-white text-xs flex items-center justify-center z-50",children:"dark"===v?"D":"L"}),(0,a.jsxs)("button",{onClick:()=>f(!y),className:"flex items-center space-x-2 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200",children:[N?(0,a.jsx)("img",{src:_(),alt:"User avatar",className:"w-8 h-8 rounded-full object-cover"}):(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white font-medium text-sm",children:_()}),(0,a.jsx)(d,{className:"w-4 h-4 text-gray-600 dark:text-gray-300 transition-transform duration-200 ".concat(y?"rotate-180":"")})]}),y&&(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-2 z-50",children:[(0,a.jsxs)("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:(null==i?void 0:i.full_name)||"User"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:r.email})]}),(0,a.jsxs)("div",{className:"py-1",children:[(0,a.jsxs)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),console.log("Theme button clicked, current theme:",v),console.log("Document classes before toggle:",document.documentElement.classList.toString()),x(),setTimeout(()=>{console.log("Document classes after toggle:",document.documentElement.classList.toString())},100)},className:"w-full flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200",children:["dark"===v?(0,a.jsx)(c,{className:"w-4 h-4 mr-3"}):(0,a.jsx)(u,{className:"w-4 h-4 mr-3"}),"dark"===v?"Light Mode":"Dark Mode"," (",v,")"]}),(0,a.jsxs)("button",{onClick:P,className:"w-full flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200",children:[(0,a.jsx)(g.A,{className:"w-4 h-4 mr-3"}),"Restart Onboarding"]}),(0,a.jsxs)("button",{onClick:w,className:"w-full flex items-center px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors duration-200",children:[(0,a.jsx)(m,{className:"w-4 h-4 mr-3"}),"Sign Out"]})]})]})]})}},2099:(e,t,r)=>{r.d(t,{N:()=>l});var a=r(5647);let s="https://gbljleyzspkuflqwsalf.supabase.co",o="sb_publishable_OLCFA9uKB3KcBWsuIZc9_g_KIbzMAsU";if(!s||!o)throw Error("Missing Supabase environment variables");let l=(0,a.UU)(s,o,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}})},2573:(e,t,r)=>{r.d(t,{$:()=>n});var a=r(5155),s=r(2115),o=r(2596),l=r(9688);let n=s.forwardRef((e,t)=>{let{className:r,variant:s="primary",size:n="md",children:i,...d}=e;return(0,a.jsx)("button",{className:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,l.QP)((0,o.$)(t))}("inline-flex items-center justify-center rounded-lg font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{primary:"bg-blue-600 text-white hover:bg-blue-700 focus-visible:ring-blue-500 dark:bg-blue-600 dark:text-white dark:hover:bg-blue-700",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200 focus-visible:ring-gray-500 dark:bg-slate-700 dark:text-white dark:hover:bg-slate-600",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus-visible:ring-gray-500 dark:border-slate-600 dark:bg-slate-800 dark:text-white dark:hover:bg-slate-700",ghost:"text-gray-700 hover:bg-gray-100 focus-visible:ring-gray-500 dark:text-gray-300 dark:hover:bg-slate-700"}[s],{sm:"h-8 px-3 text-sm",md:"h-10 px-4 py-2",lg:"h-12 px-6 text-lg"}[n],r),ref:t,...d,children:i})});n.displayName="Button"},7280:(e,t,r)=>{r.d(t,{D:()=>l,ThemeProvider:()=>n});var a=r(5155),s=r(2115);let o=(0,s.createContext)({theme:"light",toggleTheme:()=>{},setTheme:()=>{}}),l=()=>(0,s.useContext)(o),n=e=>{let{children:t}=e,[r,l]=(0,s.useState)("light"),[n,i]=(0,s.useState)(!1),d=e=>{document.querySelectorAll('[class*="bg-"], [class*="text-"], [class*="border-"]').forEach(t=>{let r=t.className.split(" ").map(t=>{if("light"===e){if(t.includes("bg-slate-9")||t.includes("bg-gray-9")||t.includes("bg-slate-8")||t.includes("bg-gray-8")||t.includes("bg-slate-7")||t.includes("bg-gray-7"))return t.replace(/bg-slate-[89]/,"bg-white").replace(/bg-gray-[89]/,"bg-white");if(t.includes("text-white")||t.includes("text-slate-100")||t.includes("text-gray-100"))return t.replace(/text-white|text-slate-100|text-gray-100/,"text-gray-900");if(t.includes("border-slate-7")||t.includes("border-gray-7"))return t.replace(/border-slate-7|border-gray-7/,"border-gray-200")}else{if(t.includes("bg-white")||t.includes("bg-slate-50")||t.includes("bg-gray-50"))return t.replace(/bg-white|bg-slate-50|bg-gray-50/,"bg-slate-900");if(t.includes("text-gray-9")||t.includes("text-slate-9"))return t.replace(/text-gray-9|text-slate-9/,"text-white");if(t.includes("border-gray-2")||t.includes("border-slate-2"))return t.replace(/border-gray-2|border-slate-2/,"border-slate-700")}return t});t.className=r.join(" ")})},c=e=>{console.log("Applying theme:",e);let t=document.documentElement,r=document.body;t.classList.remove("dark"),r.classList.remove("dark"),t.removeAttribute("data-theme"),r.removeAttribute("data-theme"),t.style.removeProperty("color-scheme"),"dark"===e?(t.classList.add("dark"),r.classList.add("dark"),t.setAttribute("data-theme","dark"),r.setAttribute("data-theme","dark"),t.style.colorScheme="dark",console.log("Applied dark theme - classes added")):(t.classList.remove("dark"),r.classList.remove("dark"),t.setAttribute("data-theme","light"),r.setAttribute("data-theme","light"),t.style.colorScheme="light",console.log("Applied light theme - dark classes removed")),"light"===e?(t.style.setProperty("--background","#fafbfc","important"),t.style.setProperty("--foreground","#1f2937","important"),t.style.setProperty("--card","#ffffff","important"),t.style.setProperty("--card-foreground","#1f2937","important"),t.style.setProperty("--popover","#ffffff","important"),t.style.setProperty("--popover-foreground","#1f2937","important"),t.style.setProperty("--primary","#3b82f6","important"),t.style.setProperty("--primary-foreground","#ffffff","important"),t.style.setProperty("--secondary","#f8fafc","important"),t.style.setProperty("--secondary-foreground","#1f2937","important"),t.style.setProperty("--muted","#f1f5f9","important"),t.style.setProperty("--muted-foreground","#6b7280","important"),t.style.setProperty("--accent","#f0f9ff","important"),t.style.setProperty("--accent-foreground","#1e40af","important"),t.style.setProperty("--destructive","#ef4444","important"),t.style.setProperty("--destructive-foreground","#ffffff","important"),t.style.setProperty("--border","#e5e7eb","important"),t.style.setProperty("--input","#e5e7eb","important"),t.style.setProperty("--ring","#3b82f6","important"),r.style.setProperty("background","#fafbfc","important"),r.style.setProperty("color","#1f2937","important"),setTimeout(()=>d("light"),50)):(t.style.setProperty("--background","#0f172a","important"),t.style.setProperty("--foreground","#f8fafc","important"),t.style.setProperty("--card","#1e293b","important"),t.style.setProperty("--card-foreground","#f8fafc","important"),t.style.setProperty("--popover","#1e293b","important"),t.style.setProperty("--popover-foreground","#f8fafc","important"),t.style.setProperty("--primary","#3b82f6","important"),t.style.setProperty("--primary-foreground","#ffffff","important"),t.style.setProperty("--secondary","#334155","important"),t.style.setProperty("--secondary-foreground","#f1f5f9","important"),t.style.setProperty("--muted","#334155","important"),t.style.setProperty("--muted-foreground","#94a3b8","important"),t.style.setProperty("--accent","#334155","important"),t.style.setProperty("--accent-foreground","#f1f5f9","important"),t.style.setProperty("--destructive","#ef4444","important"),t.style.setProperty("--destructive-foreground","#ffffff","important"),t.style.setProperty("--border","#475569","important"),t.style.setProperty("--input","#475569","important"),t.style.setProperty("--ring","#3b82f6","important"),r.style.setProperty("background","#0f172a","important"),r.style.setProperty("color","#f8fafc","important"),setTimeout(()=>d("dark"),50)),localStorage.setItem("theme",e),console.log("Saved theme to localStorage:",e),window.dispatchEvent(new CustomEvent("themeChange",{detail:{theme:e}})),setTimeout(()=>{console.log("Final state - HTML classes:",t.classList.toString()),console.log("Final state - Body classes:",r.classList.toString()),console.log("Final state - Data theme:",t.getAttribute("data-theme")),console.log("Final state - Background color:",getComputedStyle(r).backgroundColor),console.log("Final state - Text color:",getComputedStyle(r).color)},100)};return((0,s.useEffect)(()=>{i(!0);{let e=localStorage.getItem("theme"),t="light";if(e&&("light"===e||"dark"===e))console.log("Loading saved theme:",e),t=e;else{let e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";console.log("Using system theme:",e),t=e}l(t),c(t)}},[]),(0,s.useEffect)(()=>{n&&c(r)},[r,n]),n)?(console.log("ThemeProvider rendering with theme:",r),(0,a.jsx)(o.Provider,{value:{theme:r,toggleTheme:()=>{console.log("Toggle theme called, current theme:",r),l(e=>{let t="light"===e?"dark":"light";return console.log("Setting theme to:",t),t})},setTheme:e=>{console.log("Setting theme directly to:",e),l(e)}},children:t})):(console.log("ThemeProvider not mounted yet, hiding children"),(0,a.jsx)("div",{style:{visibility:"hidden"},children:t}))}},9323:(e,t,r)=>{r.d(t,{E:()=>s});var a=r(2099);let s={async getProfile(e){try{let{data:t,error:r}=await a.N.from("profiles").select("*").eq("id",e).single();if(r){if("PGRST116"===r.code)return null;throw r}return t}catch(e){return console.error("Error fetching profile:",e),null}},async createProfile(e){try{let{data:t,error:r}=await a.N.from("profiles").insert(e).select().single();if(r)throw r;return t}catch(e){return console.error("Error creating profile:",e),null}},async updateProfile(e,t){try{let{data:r,error:s}=await a.N.from("profiles").update(t).eq("id",e).select().single();if(s)throw s;return r}catch(e){return console.error("Error updating profile:",e),null}},async upsertProfile(e){try{let{data:t,error:r}=await a.N.from("profiles").upsert(e).select().single();if(r)throw r;return t}catch(e){return console.error("Error upserting profile:",e),null}},async ensureProfile(e,t,r){let a=await this.getProfile(e);return a||(a=await this.createProfile({id:e,email:t,full_name:r||null,job_type:null,swedish_level:null})),a},async signOut(){console.log("Sign out requested")},async getUserProgress(e){try{let{data:t,error:r}=await a.N.from("user_progress").select("*").eq("user_id",e);if(r)throw r;return t||[]}catch(e){return console.error("Error fetching user progress:",e),[]}},async saveLessonProgress(e){try{let{data:t,error:r}=await a.N.from("user_progress").upsert({user_id:e.user_id,lesson_id:e.lesson_id,completed:e.completed||!1,score:e.score||0,completed_at:e.completed?new Date().toISOString():null}).select().single();if(r)throw r;return t}catch(e){return console.error("Error saving lesson progress:",e),null}},async getAuthToken(){try{let{data:{session:e}}=await a.N.auth.getSession();return(null==e?void 0:e.access_token)||null}catch(e){return console.error("Error getting auth token:",e),null}},async resetProfile(e){try{let{data:t,error:r}=await a.N.from("profiles").update({job_type:null,swedish_level:null}).eq("id",e).select().single();if(r)throw r;return t}catch(e){return console.error("Error resetting profile:",e),null}}}}}]);