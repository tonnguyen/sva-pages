"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[787],{381:(e,t,r)=>{r.d(t,{A:()=>a});let a=(0,r(9946).A)("settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},1868:(e,t,r)=>{r.d(t,{A:()=>i,AuthProvider:()=>d});var a=r(5155),s=r(2115),l=r(2099),o=r(9323);let n=(0,s.createContext)({user:null,profile:null,loading:!0,signOut:async()=>{},refreshProfile:async()=>{},resetProfile:async()=>{}}),i=()=>{let e=(0,s.useContext)(n);if(!e)throw Error("useAuth must be used within an AuthProvider");return e},d=e=>{let{children:t}=e,[r,i]=(0,s.useState)(null),[d,u]=(0,s.useState)(null),[c,h]=(0,s.useState)(!0),g=async e=>{var t,r;let a=(null==(t=e.user_metadata)?void 0:t.full_name)||(null==(r=e.user_metadata)?void 0:r.name)||void 0;return await o.E.ensureProfile(e.id,e.email,a)};(0,s.useEffect)(()=>{(async()=>{let{data:{session:e}}=await l.N.auth.getSession();if((null==e?void 0:e.user)&&e.user.email){let t={id:e.user.id,email:e.user.email,user_metadata:e.user.user_metadata};i(t),u(await g(t))}h(!1)})();let{data:{subscription:e}}=l.N.auth.onAuthStateChange(async(e,t)=>{if((null==t?void 0:t.user)&&t.user.email){let e={id:t.user.id,email:t.user.email,user_metadata:t.user.user_metadata};i(e),u(await g(e))}else i(null),u(null);h(!1)});return()=>e.unsubscribe()},[]);let m=async()=>{r&&u(await o.E.getProfile(r.id))},y=async()=>{r&&u(await o.E.resetProfile(r.id))},f=async()=>{await l.N.auth.signOut(),i(null),u(null)};return(0,a.jsx)(n.Provider,{value:{user:r,profile:d,loading:c,signOut:f,refreshProfile:m,resetProfile:y},children:t})}},1935:(e,t,r)=>{r.d(t,{H:()=>m});var a=r(5155),s=r(2115),l=r(5695),o=r(1868),n=r(7280),i=r(9946);let d=(0,i.A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),u=(0,i.A)("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),c=(0,i.A)("moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);var h=r(381);let g=(0,i.A)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),m=e=>{var t;let{user:r,profile:i}=e,[m,y]=(0,s.useState)(!1),f=(0,s.useRef)(null),{signOut:v,resetProfile:p}=(0,o.A)(),{theme:b,toggleTheme:x}=(0,n.D)(),k=(0,l.useRouter)();(0,s.useEffect)(()=>{let e=e=>{f.current&&!f.current.contains(e.target)&&y(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let w=async()=>{try{await v(),window.location.href="/"}catch(e){console.error("Error signing out:",e),k.push("/")}},_=async()=>{try{await p(),k.push("/onboarding")}catch(e){console.error("Error restarting onboarding:",e),k.push("/onboarding")}},N=()=>{var e,t;return(null==(e=r.user_metadata)?void 0:e.avatar_url)?r.user_metadata.avatar_url:(null==i?void 0:i.full_name)?i.full_name.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):(null==(t=r.email)?void 0:t.charAt(0).toUpperCase())||"U"},j=!!(null==(t=r.user_metadata)?void 0:t.avatar_url);return(0,a.jsxs)("div",{className:"relative",ref:f,children:[(0,a.jsx)("div",{className:"absolute top-0 right-0 w-4 h-4 bg-red-500 rounded-full text-white text-xs flex items-center justify-center z-50",children:"dark"===b?"D":"L"}),(0,a.jsxs)("button",{onClick:()=>y(!m),className:"flex items-center space-x-2 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200",children:[j?(0,a.jsx)("img",{src:N(),alt:"User avatar",className:"w-8 h-8 rounded-full object-cover"}):(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white font-medium text-sm",children:N()}),(0,a.jsx)(d,{className:"w-4 h-4 text-gray-600 dark:text-gray-300 transition-transform duration-200 ".concat(m?"rotate-180":"")})]}),m&&(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-2 z-50",children:[(0,a.jsxs)("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:(null==i?void 0:i.full_name)||"User"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:r.email})]}),(0,a.jsxs)("div",{className:"py-1",children:[(0,a.jsxs)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),console.log("Theme button clicked, current theme:",b),console.log("Document classes before toggle:",document.documentElement.classList.toString()),x(),setTimeout(()=>{console.log("Document classes after toggle:",document.documentElement.classList.toString())},100)},className:"w-full flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200",children:["dark"===b?(0,a.jsx)(u,{className:"w-4 h-4 mr-3"}):(0,a.jsx)(c,{className:"w-4 h-4 mr-3"}),"dark"===b?"Light Mode":"Dark Mode"," (",b,")"]}),(0,a.jsxs)("button",{onClick:_,className:"w-full flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200",children:[(0,a.jsx)(h.A,{className:"w-4 h-4 mr-3"}),"Restart Onboarding"]}),(0,a.jsxs)("button",{onClick:w,className:"w-full flex items-center px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors duration-200",children:[(0,a.jsx)(g,{className:"w-4 h-4 mr-3"}),"Sign Out"]})]})]})]})}},2099:(e,t,r)=>{r.d(t,{N:()=>o});var a=r(5647);let s="https://gbljleyzspkuflqwsalf.supabase.co",l="sb_publishable_OLCFA9uKB3KcBWsuIZc9_g_KIbzMAsU";if(!s||!l)throw Error("Missing Supabase environment variables");let o=(0,a.UU)(s,l,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}})},2573:(e,t,r)=>{r.d(t,{$:()=>n});var a=r(5155),s=r(2115),l=r(2596),o=r(9688);let n=s.forwardRef((e,t)=>{let{className:r,variant:s="primary",size:n="md",children:i,...d}=e;return(0,a.jsx)("button",{className:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.QP)((0,l.$)(t))}("inline-flex items-center justify-center rounded-lg font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{primary:"bg-blue-600 text-white hover:bg-blue-700 focus-visible:ring-blue-500 dark:bg-blue-600 dark:text-white dark:hover:bg-blue-700",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200 focus-visible:ring-gray-500 dark:bg-slate-700 dark:text-white dark:hover:bg-slate-600",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus-visible:ring-gray-500 dark:border-slate-600 dark:bg-slate-800 dark:text-white dark:hover:bg-slate-700",ghost:"text-gray-700 hover:bg-gray-100 focus-visible:ring-gray-500 dark:text-gray-300 dark:hover:bg-slate-700"}[s],{sm:"h-8 px-3 text-sm",md:"h-10 px-4 py-2",lg:"h-12 px-6 text-lg"}[n],r),ref:t,...d,children:i})});n.displayName="Button"},7280:(e,t,r)=>{r.d(t,{D:()=>o,ThemeProvider:()=>n});var a=r(5155),s=r(2115);let l=(0,s.createContext)({theme:"light",toggleTheme:()=>{},setTheme:()=>{}}),o=()=>(0,s.useContext)(l),n=e=>{let{children:t}=e,[r,o]=(0,s.useState)("light"),[n,i]=(0,s.useState)(!1),d=e=>{console.log("Applying theme:",e);let t=document.documentElement,r=document.body;t.classList.remove("dark"),r.classList.remove("dark"),t.removeAttribute("data-theme"),r.removeAttribute("data-theme"),t.style.removeProperty("color-scheme"),"dark"===e?(t.classList.add("dark"),r.classList.add("dark"),t.setAttribute("data-theme","dark"),r.setAttribute("data-theme","dark"),t.style.colorScheme="dark",console.log("Applied dark theme - classes added")):(t.classList.remove("dark"),r.classList.remove("dark"),t.setAttribute("data-theme","light"),r.setAttribute("data-theme","light"),t.style.colorScheme="light",console.log("Applied light theme - dark classes removed")),localStorage.setItem("theme",e),console.log("Saved theme to localStorage:",e),window.dispatchEvent(new CustomEvent("themeChange",{detail:{theme:e}})),setTimeout(()=>{console.log("Final state - HTML classes:",t.classList.toString()),console.log("Final state - Body classes:",r.classList.toString()),console.log("Final state - Data theme:",t.getAttribute("data-theme"))},100)};return((0,s.useEffect)(()=>{i(!0);{let e=localStorage.getItem("theme"),t="light";if(e&&("light"===e||"dark"===e))console.log("Loading saved theme:",e),t=e;else{let e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";console.log("Using system theme:",e),t=e}o(t),d(t)}},[]),(0,s.useEffect)(()=>{n&&d(r)},[r,n]),n)?(console.log("ThemeProvider rendering with theme:",r),(0,a.jsx)(l.Provider,{value:{theme:r,toggleTheme:()=>{console.log("Toggle theme called, current theme:",r),o(e=>{let t="light"===e?"dark":"light";return console.log("Setting theme to:",t),t})},setTheme:e=>{console.log("Setting theme directly to:",e),o(e)}},children:t})):(console.log("ThemeProvider not mounted yet, hiding children"),(0,a.jsx)("div",{style:{visibility:"hidden"},children:t}))}},9323:(e,t,r)=>{r.d(t,{E:()=>s});var a=r(2099);let s={async getProfile(e){try{let{data:t,error:r}=await a.N.from("profiles").select("*").eq("id",e).single();if(r){if("PGRST116"===r.code)return null;throw r}return t}catch(e){return console.error("Error fetching profile:",e),null}},async createProfile(e){try{let{data:t,error:r}=await a.N.from("profiles").insert(e).select().single();if(r)throw r;return t}catch(e){return console.error("Error creating profile:",e),null}},async updateProfile(e,t){try{let{data:r,error:s}=await a.N.from("profiles").update(t).eq("id",e).select().single();if(s)throw s;return r}catch(e){return console.error("Error updating profile:",e),null}},async upsertProfile(e){try{let{data:t,error:r}=await a.N.from("profiles").upsert(e).select().single();if(r)throw r;return t}catch(e){return console.error("Error upserting profile:",e),null}},async ensureProfile(e,t,r){let a=await this.getProfile(e);return a||(a=await this.createProfile({id:e,email:t,full_name:r||null,job_type:null,swedish_level:null})),a},async signOut(){console.log("Sign out requested")},async getUserProgress(e){try{let{data:t,error:r}=await a.N.from("user_progress").select("*").eq("user_id",e);if(r)throw r;return t||[]}catch(e){return console.error("Error fetching user progress:",e),[]}},async saveLessonProgress(e){try{let{data:t,error:r}=await a.N.from("user_progress").upsert({user_id:e.user_id,lesson_id:e.lesson_id,completed:e.completed||!1,score:e.score||0,completed_at:e.completed?new Date().toISOString():null}).select().single();if(r)throw r;return t}catch(e){return console.error("Error saving lesson progress:",e),null}},async getAuthToken(){try{let{data:{session:e}}=await a.N.auth.getSession();return(null==e?void 0:e.access_token)||null}catch(e){return console.error("Error getting auth token:",e),null}},async resetProfile(e){try{let{data:t,error:r}=await a.N.from("profiles").update({job_type:null,swedish_level:null}).eq("id",e).select().single();if(r)throw r;return t}catch(e){return console.error("Error resetting profile:",e),null}}}}}]);